---
const { page } = Astro.props;

import i18next from "i18next";

export async function getStaticPaths() {
	const pages = await Astro.glob("/src/pages/en/**");

	const paths = [];
	for (const page of pages) {
		const matched = page.url.match("^/en/(.+)");
		if (!matched) {
			// root redirect pages and 404 doesn't count
			continue;
		}

		const [_, path] = matched;
		for (const locale of i18next.languages) {
			if (locale == 'en') {
				// ignore our base locale
				continue;
			}
			paths.push({ params: { locale, path }, props: { page } });
		}
	}
	return paths;
}
---

<page.Content />
